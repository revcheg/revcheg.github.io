const BODY=document.querySelector(".body"),VIDEO=document.querySelector(".video"),SETTINGS=document.querySelector(".settings"),STATISTICS=document.querySelector(".statistics"),VIDEORANGE=document.querySelector(".control__range"),STARTBUTTON=document.querySelector(".video__start"),CONTROLS=document.querySelector(".control"),playButton=document.querySelector(".control__button--play"),playButtonIcon=document.querySelector(".control__icon--play"),pauseButtonIcon=document.querySelector(".control__icon--pause");function pauseVideo(){VIDEO.paused?VIDEO.play():VIDEO.pause()}function pauseIcon(){VIDEO.paused?(playButtonIcon.classList.remove("control__icon--hide"),pauseButtonIcon.classList.add("control__icon--hide")):(playButtonIcon.classList.add("control__icon--hide"),pauseButtonIcon.classList.remove("control__icon--hide"))}playButton.addEventListener("click",pauseVideo),playButton.addEventListener("click",pauseIcon);const muteButton=document.querySelector(".control__button--volume"),muteButtonIcon=document.querySelector(".control__mute");function muteVideo(){muteButtonIcon.classList.toggle("control__mute"),VIDEO.muted?VIDEO.muted=!1:VIDEO.muted=!0}let rangeValue;muteButton.addEventListener("click",muteVideo),VIDEORANGE.addEventListener("mousedown",(()=>{VIDEO.pause()})),VIDEORANGE.addEventListener("change",(function(){rangeValue=VIDEORANGE.value,VIDEO.currentTime=rangeValue,VIDEO.paused&&(playButtonIcon.classList.add("control__icon--hide"),pauseButtonIcon.classList.remove("control__icon--hide")),VIDEO.play()}));const fullButton=document.querySelector(".control__button--size");function fullscreenVideo(){VIDEO.requestFullscreen()}let FILE,FILETYPE,FILEURL;fullButton.addEventListener("click",fullscreenVideo);const INPUTFILE=document.querySelector(".settings__file");let videoKey,game;function saveTheme(e){localStorage.setItem("localTheme",e),localStorage.setItem("localButton",buttonIndex)}function loadTheme(){if(localStorage){const e=localStorage.getItem("localTheme"),t=localStorage.getItem("localButton");setTheme(e),setButton(t)}}INPUTFILE.addEventListener("click",(function(){resetVideo()})),INPUTFILE.addEventListener("change",(function(){FILE=INPUTFILE.files[0],FILEURL=URL.createObjectURL(FILE),FILETYPE=INPUTFILE.files[0].type.replace("video/",""),VIDEO.src=FILEURL})),VIDEO.addEventListener("keyup",(e=>{switch(videoKey=e.key,videoKey){case" ":pauseVideo(),pauseIcon();break;case"ArrowLeft":VIDEO.currentTime-=5;break;case"ArrowRight":VIDEO.currentTime+=5;break;case"ArrowUp":VIDEO.volume+=.1;break;case"ArrowDown":VIDEO.volume-=.1;break;case"m":muteVideo();break;case"f":fullscreenVideo()}})),BODY.addEventListener("keyup",(e=>{switch(videoKey=e.key,videoKey){case"s":openSettings();break;case"Escape":closeSettings();break;case"l":setTheme("light"),setButton();break;case"d":setTheme("dark"),setButton();break;case"k":startVideo()}}));const chooseButtons=document.querySelectorAll(".settings__button");function setVideo(){VIDEO.src="video/"+game+"/"+deepFlag+".webm",VIDEO.preload="auto",VIDEO.volume=.5}let deepFlag;chooseButtons.forEach((e=>{e.addEventListener("click",(function(){game=this.getAttribute("data-video"),resetVideo(),setVideo(),deepCheckbox.removeAttribute("disabled","disabled")}))}));let deepCheckbox=document.querySelector(".settings__checkbox--deep");function resetVideo(){VIDEO.pause(),STARTBUTTON.classList.remove("video__start--hide"),CONTROLS.classList.add("control--hide"),STATISTICS.classList.add("statistics--hide"),playButtonIcon.classList.add("control__icon--hide"),pauseButtonIcon.classList.remove("control__icon--hide")}deepCheckbox.addEventListener("change",(function(e){deepFlag=e.currentTarget.checked?"deep":"main",setVideo()}));const openButton=document.querySelector(".header__menu"),closeButton=document.querySelector(".settings__close");function openSettings(){SETTINGS.classList.remove("settings--hide"),SETTINGS.focus()}function closeSettings(e){SETTINGS.classList.add("settings--hide"),SETTINGS.blur()}function startVideo(){VIDEO.src?(openButton.classList.remove("header__menu--error"),STARTBUTTON.classList.add("video__start--hide"),CONTROLS.classList.remove("control--off","control--hide"),VIDEO.play(),getStatistics(),startProgress()):(openButton.classList.add("header__menu--error"),setTimeout((()=>{openButton.classList.remove("header__menu--error")}),2e3))}function stayFocus(){VIDEO.addEventListener("blur",(function(){VIDEO.paused?VIDEO.blur():VIDEO.focus()}))}let videoWidth,videoHeight,videoFormat,videoDuration,videoBuffer,videoFPS,videoCurrentTime;openButton.addEventListener("click",openSettings),closeButton.addEventListener("click",closeSettings),STARTBUTTON.addEventListener("click",startVideo),VIDEO.addEventListener("ended",(function(){STARTBUTTON.classList.remove("video__start--hide"),CONTROLS.classList.add("control--hide"),STATISTICS.classList.add("statistics--hide"),VIDEO.blur()})),document.querySelector(".settings__checkbox--statistics").addEventListener("change",(function(e){e.currentTarget.checked?STATISTICS.classList.remove("statistics--off"):STATISTICS.classList.add("statistics--off")}));const statisticsResolution=STATISTICS.querySelector(".statistics__resolution"),statisticsUFH=document.querySelector(".statistics__ufh"),statisticsFormat=STATISTICS.querySelector(".statistics__format"),statisticsDuration=STATISTICS.querySelector(".statistics__duration"),statisticsFPS=STATISTICS.querySelector(".statistics__fps"),statisticsBuffer=STATISTICS.querySelector(".statistics__buffer");function getStatistics(){STATISTICS.classList.remove("statistics--hide"),videoFormat=FILETYPE||VIDEO.src.split(".").pop(),videoWidth=VIDEO.videoWidth,videoHeight=VIDEO.videoHeight,videoDuration=Math.round(VIDEO.duration),VIDEORANGE.setAttribute("max",videoDuration),setStatistics()}function setStatistics(){statisticsResolution.innerHTML=videoWidth+"x"+videoHeight,statisticsFormat.innerHTML=videoFormat,statisticsDuration.innerHTML=videoDuration,videoWidth>=3840?statisticsUFH.classList.remove("statistics--off"):statisticsUFH.classList.add("statistics--off")}let currentTheme,buttonIndex;const themeButtons=document.querySelectorAll(".footer__theme");function setButton(){themeButtons.forEach((e=>{e.removeAttribute("disabled"),e.classList.remove("footer__theme--active")})),themeButtons[buttonIndex].setAttribute("disabled","disabled"),themeButtons[buttonIndex].classList.add("footer__theme--active")}function setTheme(e){switch(BODY.className="",e){case"light":BODY.classList.add(e),buttonIndex=0;break;case"dark":BODY.classList.add(e),buttonIndex=1;break;case"cyberpunk":BODY.classList.add(e),buttonIndex=2}}let progressInterval,playbackQuality;currentTheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",themeButtons.forEach((function(e,t){e.addEventListener("click",(function(){buttonIndex=Array.from(themeButtons).indexOf(e),currentTheme=this.getAttribute("data-theme"),setButton(buttonIndex),setTheme(currentTheme),saveTheme(currentTheme)}))})),setTheme(currentTheme),setButton(buttonIndex),loadTheme();const videoPassed=CONTROLS.querySelector(".control__passed"),videoLeft=CONTROLS.querySelector(".control__left");function formatTime(e){let t=Math.floor(e/3600),o=Math.floor((e-3600*t)/60),s=Math.floor(e-3600*t-60*o);return t<10&&(t="0"+t),o<10&&(o="0"+o),s<10&&(s="0"+s),t+":"+o+":"+s}function startProgress(){progressInterval=setTimeout(updateProgress,1e3)}function updateProgress(){videoBuffer=Math.round(VIDEO.buffered.end(0)),videoCurrentTime=VIDEO.currentTime,VIDEORANGE.value=videoCurrentTime,statisticsBuffer.innerHTML=videoBuffer,playbackQuality=VIDEO.getVideoPlaybackQuality(),videoFPS=playbackQuality.totalVideoFrames/VIDEO.currentTime,statisticsFPS.innerHTML=videoFPS;let e=formatTime(videoCurrentTime),t=formatTime(videoDuration-videoCurrentTime);videoPassed.innerHTML=e,videoLeft.innerHTML=t,startProgress(),stayFocus()}function stopProgress(){clearTimeout(progressInterval)}VIDEO.addEventListener("play",startProgress),VIDEO.addEventListener("pause",stopProgress),VIDEO.addEventListener("ended",stopProgress);